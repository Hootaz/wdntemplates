(function(a){a.fn.extend({infiniteCarousel:function(u){u=a.extend({transitionSpeed:800,displayTime:6E3,textholderHeight:0.15,displayProgressBar:true,displayThumbnails:true,displayThumbnailNumbers:true,displayThumbnailBackground:true,thumbnailWidth:"20px",thumbnailHeight:"20px",thumbnailFontSize:".7em",easeLeft:"linear",easeRight:"linear",imagePath:"/js/infinitecarousel/images/",inView:1,padding:"0px",advance:1,showControls:true,autoHideControls:false,autoHideCaptions:false,autoStart:true,prevNextInternal:true,
enableKeyboardNav:true,onSlideStart:function(){},onSlideEnd:function(){},onPauseClick:function(){}},u);return this.each(function(){function A(e){e=e==null?b.displayTime:e;a("#progress"+c).width("100%").height(5);a("#progress"+c).animate({width:0},e)}function v(e,q){if(g){a("#minmax"+c+"_"+q).hide();a("#close"+c+"_"+q).hide()}if(e!=null){a("#textholder"+c+"_"+q+" span").html(e);a("#textholder"+c+"_"+q).stop().animate({marginBottom:"0px"},500);a("#minmax"+c+"_"+q).css("background-position","0 -8px");
B()}}function B(){if(!g){a(".minmax",d).fadeIn(250);a(".close",d).fadeIn(250)}}function w(){a(".textholder",d).stop().animate({marginBottom:-l*b.textholderHeight-j-12+"px"},b.transitionSpeed)}function C(){b.enableKeyboardNav&&a(document).keydown(function(e){if(e.keyCode==39){m("next");a(document).unbind("keydown")}if(e.keyCode==37){m("prev");a(document).unbind("keydown")}if(e.keyCode==80||e.keyCode==111)y();if(e.keyCode==83||e.keyCode==115){s();a(document).unbind("keydown")}})}function m(e){b.onPauseClick.call(this);
a("#btn_rt"+c).unbind("click");a("#btn_lt"+c).unbind("click");setTimeout(function(){a("#play_pause_btn"+c).css("background-position","0 -16px")},b.transitionSpeed-1);g=0;a("#progress"+c).stop().fadeOut();n="pause";clearTimeout(r);e=="prev"?D():o();a("#play_pause_btn"+c).unbind("click");setTimeout(function(){a("#play_pause_btn"+c).bind("click",function(){s()});a("#btn_rt"+c).bind("click",function(){m("next")});a("#btn_lt"+c).bind("click",function(){m("prev")})},b.transitionSpeed)}function y(){a("#play_pause_btn"+
c).unbind("click");if(g){b.onPauseClick.call(this);a("#play_pause_btn"+c).fadeTo(250,0,function(){a(this).css({"background-position":"0 -16px",opacity:".5"})}).animate({opacity:0.5},250);g=0;B();a("#progress"+c).stop().fadeOut();clearTimeout(r);setTimeout(function(){a("#play_pause_btn"+c).bind("click",function(){s()})},b.transitionSpeed)}}function s(){a("#play_pause_btn"+c).unbind("click");if(!g){setTimeout(function(){a("#play_pause_btn"+c).css("background-position","0 0")},b.transitionSpeed-1);g=
1;o();r=setInterval(function(){o()},b.displayTime+b.transitionSpeed);setTimeout(function(){a("#play_pause_btn"+c).bind("click",function(){y()})},b.transitionSpeed)}}function E(){w();if(b.showControls&&b.prevNextInternal){a("#play_pause_btn"+c).fadeOut(200);a("#btn_lt"+c).fadeOut(200);a("#btn_rt"+c).fadeOut(200)}if(b.displayThumbnails)for(i=1;i<=k;i++)a("#thumb"+c+"_"+i).css({"border-color":"#ccc"}).animate({opacity:0.65},500)}function F(){if(b.showControls&&b.prevNextInternal){a("#play_pause_btn"+
c).fadeIn(200);a("#btn_lt"+c).fadeIn(200);a("#btn_rt"+c).fadeIn(200)}C();b.autoHideCaptions&&z&&G();if(b.displayThumbnails)for(i=0;i<f.length;i++)a("#thumb"+c+"_"+f[i]).css({"border-color":"#ff0000"}).animate({opacity:1},500);if(!b.autoHideCaptions)for(i=1;i<=b.inView;i++)v(a("li:eq("+i+") p",d).html(),i);b.displayThumbnails&&a("#thumbs"+c+" div").bind("click",H).css({cursor:"pointer"});ary=[];for(x=1;x<=b.inView;x++)ary.push(a("img:eq("+x+")",d).attr("src"));b.onSlideEnd.call(this,ary)}function o(e){if(e==
null)e=b.advance;E();if(b.displayThumbnails)for(i=1;i<=e;i++){f.push(p.shift());p.push(f.shift())}b.displayTime==0&&clearInterval(r);a("li:lt("+e+")",d).clone(true).insertAfter(a("li:last",d));b.onSlideStart.call(this,f,"left");a("ul",d).animate({left:-h*(e+1)-parseInt(b.padding)*(e+1)*2},b.transitionSpeed,b.easeLeft,function(){a("li:lt("+e+")",d).remove();a(this).css({left:-h-parseInt(b.padding)*2});b.displayProgressBar&&g&&A();F();b.displayTime==0&&o()})}function D(e){if(e==null)e=b.advance;E();
if(b.displayThumbnails)for(i=1;i<=e;i++){f.unshift(p.pop());p.unshift(f.pop())}a("li:gt("+(k-(e+1))+")",d).clone(true).insertBefore(a("li:first",d));b.onSlideStart.call(this,f,"right");a("ul",d).css("left",-(h*(e+1))-parseInt(b.padding)*(e+1)*2).animate({left:-h-parseInt(b.padding)*2},b.transitionSpeed,b.easeRight,function(){a("li:gt("+(k-1)+")",d).remove();F()})}var c=Math.round(Math.random()*1E8),b=u,d=a(this),g=b.autoStart,k=a("img",d).length,l=a("img:first",d).height(),h=a("img:first",d).width();
if(b.inView>k-1)b.inView=k-1;a("p",d).hide();a(d).css({position:"relative",overflow:"hidden"}).width(h*b.inView+b.inView*parseInt(b.padding)*2).height(l+parseInt(b.padding)*2);a("ul",d).css({"list-style":"none",margin:"0",padding:"0",position:"relative"}).width(h*k);a("li",d).css({display:"inline","float":"left",padding:b.padding});a("li:last",d).prependTo(a("ul",d));a("ul",d).css("left",-h-parseInt(b.padding)*2+"px").width(9999);if(b.displayProgressBar){a(d).append('<div id="progress'+c+'" class="ic-progress-bar" style="position:absolute;bottom:0;background:#bbb;left:0;z-index:1"></div>');
a("#progress"+c).width("100%").height(5).css("opacity",".6")}var j=parseInt(a(d).css("border-bottom-width"))+parseInt(a(d).css("border-top-width"));if(isNaN(j))j=0;var t=parseInt(a(d).css("padding-left"));for(i=1;i<=b.inView;i++){a(d).append('<div id="textholder'+c+"_"+i+'" class="textholder" style="position:absolute;width:'+h+"px;bottom:0px;margin-bottom:"+-(l*b.textholderHeight+j)+'px;"><span></span></div>');a("#textholder"+c+"_"+i).css({left:(i-1)*(h+parseInt(b.padding)*2),"margin-left":parseInt(b.padding)+
t,"margin-right":b.padding});a("#textholder"+c+"_"+i).height(l*b.textholderHeight);html='<div class="minmax" id="minmax'+c+"_"+i+'" style="width:8px;height:8px;position:absolute;top:1px;right:10px;cursor:pointer;background:url('+b.imagePath+'caption.gif) no-repeat 0 -8px"></div>';html+='<div class="close" id="close'+c+"_"+i+'" style="width:8px;height:8px;position:absolute;top:1px;right:1px;cursor:pointer;background:url('+b.imagePath+'caption.gif) no-repeat 0 0"></div>';a("#textholder"+c+"_"+i).append(html);
a("#minmax"+c+"_"+i).hide();a("#close"+c+"_"+i).hide();b.autoHideCaptions||v(a("li:eq("+i+") p",d).html(),i)}t=parseInt(a("#textholder"+c+"_1").css("padding-left"))+parseInt(a("#textholder"+c+"_1").css("padding-right"));t>0&&a(".textholder",d).width(h-t);a(".close",d).each(function(e){a(this).click(function(){a("#textholder"+c+"_"+(e+1)).animate({marginBottom:-l*b.textholderHeight-j-12+"px"},500)})});a(".minmax",d).each(function(e){a(this).click(function(){parseInt(a("#textholder"+c+"_"+(e+1)).css("margin-bottom"))==
0?a("#textholder"+c+"_"+(e+1)).animate({marginBottom:-l*b.textholderHeight-j+12+"px"},500,function(){a("#minmax"+c+"_"+(e+1)).css("background-position","0 -16px")}):a("#textholder"+c+"_"+(e+1)).animate({marginBottom:"0px"},500,function(){a("#minmax"+c+"_"+(e+1)).css("background-position","0 -8px")})})});if(b.displayThumbnails){function H(){target_num=this.id.split("_");if(f[0]!=target_num[1]){n="pause";a("#progress"+c).stop().fadeOut();clearTimeout(r);a("#thumbs"+c+" div").css({cursor:"default"}).unbind("click");
g=0;setTimeout(function(){a("#play_pause_btn"+c).css("background-position","0 -16px")},b.transitionSpeed)}if(target_num[1]>f[0]){diff=target_num[1]-f[0];o(diff)}if(target_num[1]<f[0]){diff=f[0]-target_num[1];D(diff)}}var f=[],p=[];a(d).after('<div id="thumbs'+c+'" style="position:relative;overflow:auto;clear:left;text-align:left;padding-top:5px;"></div>');for(i=0;i<=k-1;i++){thumb=a("img:eq("+(i+1)+")",d).attr("src");a("#thumbs"+c).append('<div class="thumb" id="thumb'+c+"_"+(i+1)+'" style="cursor:pointer;background-image:url('+
thumb+");background-size:auto 100%;-moz-background-size:auto 100%;-webkit-background-size:auto 100%;display:inline;float:left;width:"+b.thumbnailWidth+";height:"+b.thumbnailHeight+";line-height:"+b.thumbnailHeight+";padding:0;overflow:hidden;text-align:center;border:2px solid #ccc;margin-right:4px;font-size:"+b.thumbnailFontSize+';font-family:Arial;color:#000;text-shadow:0 0 3px #fff">'+(i+1)+"</div>");i<=b.inView&&a("#thumb"+c+"_"+i).css({"border-color":"#ff0000"});p.push(i+1)}for(i=1;i<=b.inView;i++)f.push(p.shift());
thumb=a("img:first",d).attr("src");a("#thumb"+c+"_"+k).css({"background-image":"url("+thumb+")"});a("#thumbs"+c+" div.thumb:not(:first)").css({opacity:0.65});a("#thumbs"+c+" div.thumb").hover(function(){a(this).animate({opacity:1},150)},function(){f[0]!=this.id.split("_")[1]&&a(this).animate({opacity:0.65},250)});a("#thumbs"+c+" div").bind("click",H);b.displayThumbnailNumbers||a("#thumbs"+c+" div").text("");b.displayThumbnailBackground||a("#thumbs"+c+" div").css({"background-image":"none"})}if(b.showControls){html=
'<div id="play_pause_btn'+c+'" style="cursor:pointer;position:absolute;top:3px;right:3px;border:none;width:16px;height:16px;background:url('+b.imagePath+'playpause.gif) no-repeat 0 0"></div>';a(d).append(html);var n="play";a("#play_pause_btn"+c).css("opacity",0.5).hover(function(){a(this).animate({opacity:"1"},250)},function(){a(this).animate({opacity:".5"},250)});a("#play_pause_btn"+c).click(function(){n=n=="play"?"pause":"play";n=="play"?s():y()});if(!b.prevNextInternal){wrapID=a(d).attr("id")+
"Wrapper";a(d).wrap('<div id="'+wrapID+'"></div>').css("margin","0 auto");a("#"+wrapID).css("position","relative").width(a(d).width()+40+parseInt(a(d).css("padding-left"))+parseInt(a(d).css("padding-right")))}arrowsTop=l/2-15+parseInt(b.padding);html='<div id="btn_rt'+c+'" style="position:absolute;right:2px;top:'+arrowsTop+"px;cursor:pointer;border:none;width:13px;height:30px;background:url("+b.imagePath+'leftright.gif) no-repeat 0 0"></div>';html+='<div id="btn_lt'+c+'" style="position:absolute;left:2px;top:'+
arrowsTop+"px;cursor:pointer;border:none;width:13px;height:30px;background:url("+b.imagePath+'leftright.gif) no-repeat -13px 0"></div>';b.prevNextInternal?a(d).append(html):a("#"+wrapID).append(html);a("#btn_rt"+c).css("opacity",0.5).click(function(){m("next")}).hover(function(){a(this).animate({opacity:"1"},250)},function(){a(this).animate({opacity:".5"},250)});a("#btn_lt"+c).css("opacity",0.5).click(function(){m("prev")}).hover(function(){a(this).animate({opacity:"1"},250)},function(){a(this).animate({opacity:".5"},
250)});if(b.autoHideControls&&b.prevNextInternal){function J(){a("#play_pause_btn"+c).stop().animate({top:"3px",right:"3px"},250);a("#btn_rt"+c).stop().animate({top:arrowsTop+"px",right:"2px"},250);a("#btn_lt"+c).stop().animate({top:arrowsTop+"px",left:"2px"},250)}function I(){a("#play_pause_btn"+c).stop().animate({top:-16-j+"px",right:-16-j+"px"},250);a("#btn_rt"+c).stop().animate({right:"-16px"},250);a("#btn_lt"+c).stop().animate({left:"-16px"},250)}a(d).hover(J,I);I()}if(b.autoHideCaptions){var z;
function G(){z=true;for(i=1;i<=b.inView;i++)v(a("li:eq("+i+") p",d).html(),i)}function K(){z=false;w()}a(d).hover(G,K);w()}}if(g){var r=setInterval(function(){o()},b.displayTime+b.transitionSpeed);b.displayProgressBar&&A(b.displayTime+b.transitionSpeed)}else{n="pause";a("#play_pause_btn"+c).css({"background-position":"0 -16px"})}C()})}})})(WDN.jQuery);
